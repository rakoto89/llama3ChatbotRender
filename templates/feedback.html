<!DOCTYPE html> 
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Rate your experience</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
   <div class="feedback-container">
       <div class="feedback-card">
           <h1>Rate your experience</h1>
           <p>We highly value your feedback! Rate your experience and provide us with your valuable feedback.</p>

           <form id="feedback-form" method="POST" action="/submit-feedback">
               <!-- Star Rating Section -->
               <div class="center">
                   <div class="stars">
                       <input type="radio" id="star5" name="rate" value="5"><label for="star5">‚≠ê</label>
                       <input type="radio" id="star4" name="rate" value="4"><label for="star4">‚≠ê</label>
                       <input type="radio" id="star3" name="rate" value="3"><label for="star3">‚≠ê</label>
                       <input type="radio" id="star2" name="rate" value="2"><label for="star2">‚≠ê</label>
                       <input type="radio" id="star1" name="rate" value="1"><label for="star1">‚≠ê</label>
                   </div>
               </div>

               <!-- Text Box for Additional Comments -->
               <textarea id="comments" name="comments" rows="4" placeholder="Write your feedback here..."></textarea>

               <!-- Button Section -->
               <div class="button-container">
                   <button type="submit" class="btn-submit">Send Feedback</button>
                   <button type="button" id="return-chatbot" class="btn-return">Return to Chatbot</button>
                   <button type="button" id="skip-feedback" class="btn-skip">Skip Feedback</button>
               </div>
           </form>

           <div id="success-message" style="display: none;">
               <p>Thank you for your feedback! üôå</p>
           </div>
       </div>
   </div>

   <script>
       // Handle Feedback Form Submission
       document.getElementById("feedback-form").onsubmit = function(event) {
           event.preventDefault();

           const formData = new FormData(event.target);

           fetch("/submit-feedback", {
               method: "POST",
               body: formData,
           })
           .then(response => {
               if (response.ok) {
                   document.getElementById("feedback-form").style.display = "none";
                   document.getElementById("success-message").style.display = "block";
               } else {
                   alert("Error submitting feedback. Please try again.");
               }
           })
           .catch(() => {
               alert("An error occurred. Please check your connection.");
           });
       };

       // Return to Chatbot Button
       document.getElementById("return-chatbot").addEventListener("click", () => {
           window.location.href = "/";
       });

       // Skip Feedback Button
       document.getElementById("skip-feedback").addEventListener("click", () => {
           window.location.href = "/";
       });

       // Custom Star Rating Script
       const starInputs = document.querySelectorAll('.stars input[type="radio"]');
       starInputs.forEach(input => {
           input.addEventListener('change', () => {
               const allLabels = [...input.parentElement.querySelectorAll('label')].reverse();
               let found = false;
               allLabels.forEach(label => {
                   if (input.id === label.getAttribute('for')) {
                       found = true;
                   }
                   label.style.color = found ? 'gold' : 'white';
               });
           });
       });
   </script>
</body>
</html>
