<!DOCTYPE html> 
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Rate your experience</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='feedback.css') }}">
</head>
<body>
   <div class="feedback-container">
       <div class="feedback-card">
           <h1>Rate your experience</h1>
           <p>We highly value your feedback! Rate your experience and provide us with your valuable feedback.</p>

           <form id="feedback-form" method="POST" action="/feedback">
               <!-- Emoji Rating Section -->
               <div class="emoji-rating">
                   <label>
                       <input type="radio" name="rate" value="5">
                       <span>😊 5 Stars</span>
                   </label>
                   <label>
                       <input type="radio" name="rate" value="4">
                       <span>🙂 4 Stars</span>
                   </label>
                   <label>
                       <input type="radio" name="rate" value="3">
                       <span>😐 3 Stars</span>
                   </label>
                   <label>
                       <input type="radio" name="rate" value="2">
                       <span>🙁 2 Stars</span>
                   </label>
                   <label>
                       <input type="radio" name="rate" value="1">
                       <span>😡 1 Star</span>
                   </label>
               </div>

               <!-- Text Box for Additional Comments -->
               <textarea id="comments" name="comments" rows="4" placeholder="Write your feedback here..."></textarea>

               <!-- Button Section -->
               <div class="button-container">
                   <button type="submit" class="btn-submit">Send Feedback</button>
                   <button type="button" id="return-chatbot" class="btn-return">Return to Chatbot</button>
                   <button type="button" id="skip-feedback" class="btn-skip">Skip Feedback</button>
               </div>
           </form>

           <div id="success-message" style="display: none;">
               <p>Thank you for your feedback! 🙌</p>
           </div>
       </div>
   </div>

   <script>
       document.getElementById("feedback-form").onsubmit = function(event) {
           event.preventDefault();

           // Get selected rating value
           const selectedRating = document.querySelector('input[name="rate"]:checked');
           const comments = document.getElementById("comments").value;

           if (!selectedRating) {
               alert("Please select a rating before submitting.");
               return;
           }

           const formData = new FormData();
           formData.append("rate", selectedRating.value);
           formData.append("comments", comments);

           fetch("/feedback", {
               method: "POST",
               body: formData
           })
           .then(response => response.text())
           .then(data => {
               document.getElementById("success-message").style.display = "block";
               document.getElementById("feedback-form").reset();
           })
           .catch(error => console.error("Error:", error));
       };

       // Return to chatbot function
       document.getElementById("return-chatbot").addEventListener("click", function() {
           window.location.href = "/chatbot";  // Update this URL to match your chatbot route
       });

       // Skip feedback and go back to chatbot
       document.getElementById("skip-feedback").addEventListener("click", function() {
           window.location.href = "/chatbot";  // Update this URL to match your chatbot route
       });
   </script>
</body>
</html>
